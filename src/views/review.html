{% extends "layout.html" %}

{% block content %}
<div class="container mb-8 mx-auto flex items-center w-full bg-red-100">
  <div class="w-full h-screen bg-white rounded shadow-lg p-8 m-4 md:max-w-sm md:mx-auto">
    <h1 class="block w-full text-center text-3xl text-grey-darkest mb-6">Review</h1>
    <form action="/review" method="post">
      <div class="w-full md:w-1/3 px-3 mb-6 md:mb-0">
        <label class="block uppercase tracking-wide text-gray-700 text-s font-bold mb-2" for="name">Restaurant Name</label>
        <select class="form-input border py-2 px-3 text-grey-darkest md:mr-2" name="name">
           {% for name in names %}
             {%if name.key === selectedName %}
             <option value="{{ name.key }}" selected >{{ name.key }}</option>
             {%else %}
             <option value="{{ name.key }}">{{ name.name }}</option>
             {%endif %}
           {% endfor %} 
         </select>
      </div>
      <div class="w-full md:w-1/3 px-3 mb-6 md:mb-0">
        <label class="block uppercase tracking-wide text-gray-700 text-s font-bold mb-2" for="name">General Review</label>
        <textarea placeholder="type away" class="form-textarea text-grey-darkest flex-1 p-2 m-1 bg-transparent" name="review" id="review">...</textarea>
      </div>
      <div class="w-full md:w-1/3 px-3 mb-6 md:mb-0">
        <label class="block uppercase tracking-wide text-gray-700 text-s font-bold mb-2" for="name">How many courses?</label>
        <input class="form-input border py-2 px-3 text-grey-darkest md:mr-2" type="text" name="link" id="link">
      </div>
      <div class="w-full md:w-1/3 px-3 mb-6 md:mb-0">
        <label class="block uppercase tracking-wide text-gray-700 text-s font-bold mb-2" for="name">Upload Photo</label>
        <input class="form-input border py-2 px-3 text-grey-darkest md:mr-2" type="text" name="link" id="link">
      </div>
     <br>
        {{ msg }}
     <br>
      <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">Submit</button>
    </form>
</div>
<script>
  document.querySelector('#myImage').addEventListener('change', (event) => {
    handleImageUpload(event)
  })

  const handleImageUpload = event => {
    const files = event.target.files
    const formData = new FormData()
    formData.append('myImage', files[0])

    fetch('/upload', {
      method: 'POST',
      body: formData
    })
    .then(data => {
      console.log(data)
    })
    .catch(error => {
      console.error(error)
    })
  }
</script>
</div>
{% endblock %}

